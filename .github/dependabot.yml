# Dependabot 依赖安全更新配置
# 整改方案 v2.1 — Z-02 安全扫描基线
#
# 功能：
# - 自动检测 npm 依赖的已知漏洞
# - 每周一自动创建 PR 更新有漏洞的依赖
# - Docker 基础镜像安全更新

version: 2
updates:
  # npm 依赖更新
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Asia/Shanghai"
    # 限制同时打开的 PR 数量，避免 PR 洪水
    open-pull-requests-limit: 10
    # 仅更新安全补丁（不自动升级 minor/major）
    versioning-strategy: "increase-if-necessary"
    # 自动分配审查者
    reviewers:
      - "xilian-dev"
    labels:
      - "dependencies"
      - "security"
    # 忽略破坏性更新（需要手动评估）
    ignore:
      # 大版本升级需要手动评估兼容性
      - dependency-name: "*"
        update-types: ["version-update:semver-major"]

  # Docker 基础镜像更新
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Asia/Shanghai"
    open-pull-requests-limit: 5
    labels:
      - "dependencies"
      - "docker"
      - "security"

  # GitHub Actions 更新
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 5
    labels:
      - "dependencies"
      - "ci"
