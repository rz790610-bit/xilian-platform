# 西联智能平台功能检查清单

## 数据接入模块 (/data/access)
- [ ] 添加数据源按钮 - 弹窗是否正常
- [ ] 数据源卡片操作按钮（编辑、删除、同步）是否有效
- [ ] 标签页切换是否正常
- [ ] 数据源状态显示是否正确

## 数据标准化模块 (/data/standard)
- [ ] 设备编码 - 添加/编辑/删除功能
- [ ] 测点编码 - 添加/编辑/删除功能
- [ ] 单位换算 - 添加/编辑/删除功能
- [ ] 故障分类 - 添加/编辑/删除功能
- [ ] 工况阈值 - 添加/编辑/删除功能
- [ ] 质量规则 - 添加/编辑/删除功能
- [ ] 导入/导出配置功能
- [ ] 编码验证功能

## 系统设置模块 (/settings/*)
- [ ] 资源总览 - 数据显示
- [ ] 大模型管理 - 保存配置、拉取模型
- [ ] 数据库管理 - 添加/测试连接/删除
- [ ] 插件管理 - 开关切换
- [ ] 引擎模块 - 开关切换
- [ ] 系统拓扑 - 添加节点
- [ ] 模型库 - 加载/卸载模型

## 数据管理模块 (/data/manage)
- [ ] 文件上传功能
- [ ] 文件搜索功能
- [ ] 批量操作功能

## 数据标注模块 (/data/label)
- [ ] 文件选择
- [ ] 标注保存
- [ ] AI自动标注
- [ ] 导入/导出标注

## Pipeline编辑器 (/pipeline)
- [ ] 节点拖拽
- [ ] 节点连接
- [ ] 导入/导出配置

## 智能体诊断 (/agents)
- [ ] 智能体选择
- [ ] 对话功能

## AI对话 (/chat)
- [ ] 消息发送
- [ ] 历史记录


## 知识库与知识图谱模块

- [x] 创建知识库管理页面（文件上传、自动处理）
- [x] 创建知识图谱可视化页面（实体关系图）
- [x] 实现后端文件处理 API（PDF/Word/Excel 解析）
- [x] 实现实体关系抽取 API（使用 LLM）
- [x] 更新导航配置添加知识库菜单
- [x] 集成到现有 AI 对话系统


## 知识库增强功能

- [x] 安装 PDF/Word 解析库（pdf-parse, mammoth）
- [x] 集成文档解析到后端 API
- [x] 集成 Qdrant 向量数据库到后端
- [x] 创建知识图谱数据库表
- [x] 实现知识图谱数据持久化


## AI 对话文件上传功能

- [x] 添加文件上传按钮和拖拽区域
- [x] 支持 PDF/Word/TXT/CSV 文件解析
- [x] 将文件内容作为上下文发送给 AI
- [x] 添加从知识库选择文档功能
- [x] 附件预览和删除功能
- [x] 创建 listKnowledgePoints API 端点


## Nomic-Embed-Text 模型集成

- [x] 安装 nomic-embed-text 模型到 Ollama
- [x] 更新知识库后端使用 Ollama 嵌入 API
- [x] 替换简单哈希嵌入为 nomic-embed-text
- [x] 默认向量维度更新为 768
- [x] 测试语义检索效果


## 知识库向量管理后台

- [x] 创建向量管理后台页面 (VectorAdmin.tsx)
- [x] 实现向量统计仪表盘（集合数量、向量总数、维度信息）
- [x] 实现向量分布可视化（2D 散点图展示向量聚类）
- [x] 实现向量检索测试功能（输入文本测试相似度搜索）
- [x] 实现向量详情查看和元数据编辑功能
- [x] 添加路由和导航入口


## t-SNE/PCA 降维可视化

- [x] 安装 druid.js 降维算法库
- [x] 创建前端降维计算服务 (dimensionReduction.ts)
- [x] 更新向量可视化组件使用真实降维结果
- [x] 添加 PCA/t-SNE/UMAP 算法切换选项
- [x] 优化大规模向量的降维性能（归一化处理）


## 向量聚类分析功能

- [x] 实现 K-Means++ 聚类算法
- [x] 添加聚类数量选择器 (2-10)
- [x] 在可视化中显示聚类边界和中心点
- [x] 显示每个聚类的统计信息（数量、代表性知识点）
- [x] 添加聚类颜色映射（10色调色板）


## 向量数据导出功能

- [x] 在可视化图表右上角添加导出按钮
- [x] 实现 CSV 导出功能（包含降维坐标和聚类结果）
- [x] 导出字段：ID、标题、X坐标、Y坐标、类别、聚类ID、降维算法


## 本地化部署文件 (v3)

- [x] 创建 dist 静态文件目录
- [x] 创建 server.js (Node.js 服务器)
- [x] 创建 server.py (Python 服务器)
- [x] 创建 start.sh (Linux/Mac 启动脚本)
- [x] 创建 start.bat (Windows 启动脚本)
- [x] 创建 README.md 部署文档
- [x] 创建 xilian-deploy-v3.zip 压缩包


## 功能修复 - 文档上传和解析

- [x] 创建 documentParser.ts 文档解析服务
- [x] 安装 pdfjs-dist, mammoth, xlsx 解析库
- [x] 修复知识库管理的文档上传功能
- [x] 修复AI对话的文档解析功能
- [x] 支持 PDF/Word/Excel/CSV/TXT/MD/JSON 格式
- [x] 重新构建并生成部署包 (v3.1)


## OCR 文字识别功能

- [x] 安装 Tesseract.js 库
- [x] 创建 OCR 服务模块 (ocrService.ts)
- [x] 支持图片文件 (PNG/JPG/JPEG/BMP/TIFF/WEBP/GIF)
- [x] 支持扫描版 PDF 的 OCR 识别
- [x] 集成到文档解析服务
- [x] 更新 UI 支持图片上传
- [x] 添加 OCR 进度提示
- [x] 重新生成部署包 (v3.2)


## AI对话文档同步到知识库

- [x] 在文档上传区域添加"同时保存到知识库"复选框
- [x] 实现文档内容保存到 Qdrant 的逻辑
- [x] 使用当前选中的知识库集合
- [x] 显示保存状态提示 (Toast)
- [x] 重新生成部署包 (v3.3)


## 本地化部署包 v4.0

- [x] 重新生成本地化部署包 v4.0


## 系统拓扑功能开发

- [ ] 分析当前系统拓扑页面实现状态
- [ ] 设计拓扑节点和连接的数据库表结构
- [ ] 实现后端 tRPC API（节点CRUD、连接CRUD、状态查询）
- [ ] 重构前端拓扑可视化组件（支持拖拽、缩放、连线）
- [ ] 实现节点添加/编辑/删除功能
- [ ] 实现连接添加/删除功能
- [ ] 实现节点状态实时监控
- [ ] 实现拓扑布局保存和恢复
- [ ] 测试所有功能


## 系统拓扑自动更新功能

- [x] 实现后端服务健康检查（Ollama、Qdrant等）
- [x] 创建自动状态检测定时任务
- [x] 添加状态变化检测和自动同步API
- [x] 前端实现定时轮询获取最新状态
- [x] 状态变化时自动更新拓扑图
- [x] 添加服务自动发现机制


## 系统拓扑自动生成功能

- [x] 设计自动发现服务的架构
- [x] 实现服务自动扫描（端口检测、进程检测）
- [x] 自动创建节点并设置类型和图标
- [x] 自动发现服务依赖关系并生成连接
- [x] 实现智能布局算法（按类型分层排列）
- [x] 前端一键生成拓扑按钮
- [x] 支持增量更新（只添加新发现的服务）


## 大模型功能模块

- [x] 分析现有模型相关页面和功能状态
- [x] 设计模型相关数据库表结构
- [x] 实现模型管理后端API
- [x] 实现模型仓库功能（本地模型、远程模型）
- [x] 实现模型推理和对话功能
- [ ] 实现模型微调功能（待完善）
- [ ] 实现模型评估功能（待完善）
- [x] 完善模型中心UI界面


## 框架优化 - 基于v2.2文档

### 数据库分层存储
- [ ] 实现设备遥测数据模块（模拟时序数据）
- [ ] 实现传感器数据聚合视图
- [ ] 添加设备台账管理功能
- [ ] 实现诊断规则引擎

### 数据流层实现
- [x] 设计设备、传感器、遥测数据表结构
- [x] 实现事件总线模块（内存队列模拟Kafka）
- [x] 实现实时计算和滑动窗口异常检测（模拟Flink）
- [x] 实现传感器数据流和聚合
- [x] 创建前端数据流监控界面

### 插件引擎
- [ ] 实现插件manifest解析
- [ ] 实现插件生命周期管理（激活/停用）
- [ ] 实现插件配置管理
- [ ] 添加插件执行日志

### 数据流与工作流
- [ ] 实现事件总线模块
- [ ] 实现工作流定义和执行
- [ ] 添加定时任务调度
- [ ] 实现数据管道配置

### API规范
- [ ] 统一API响应格式
- [ ] 实现错误码体系
- [ ] 添加请求限流
- [ ] 实现API版本管理


## Kafka 真实集成（企业版数据流）

- [x] 创建 Docker Compose 配置部署 Kafka 和 Zookeeper
- [x] 安装 kafkajs 库并创建 Kafka 客户端服务
- [x] 创建 Kafka 事件总线适配器（支持真实 Kafka 和内存回退）
- [x] 创建 Kafka 流处理器（滑动窗口异常检测、数据聚合）
- [x] 创建 Kafka 主题管理功能
- [x] 更新前端监控界面显示 Kafka 状态
- [x] 编写本地部署文档和启动脚本


## Redis 缓存层集成

- [x] 安装 ioredis 库
- [x] 创建 Redis 客户端服务
- [x] 实现会话缓存功能
- [x] 实现 API 限流功能
- [x] 实现实时数据缓存
- [x] 更新 Docker Compose 添加 Redis 服务
- [x] 创建 Redis 管理路由


## Kafka 监控仪表盘

- [x] 创建 Kafka 监控页面组件
- [x] 实现集群状态卡片
- [x] 实现主题列表和状态展示
- [x] 实现消费者组监控
- [x] 实现吞吐量图表
- [x] 实现异常告警列表
- [x] 添加导航菜单入口


## 本地部署配置

- [x] 更新启动脚本支持同时启动 Kafka 和 Redis
- [x] 创建环境变量配置模板 (.env.local.example)
- [x] 编写详细的本地部署文档
- [x] 添加健康检查和状态验证

- [x] 修复健康检查模块添加 Redis 和 Kafka 状态检测


## 环境变量自动加载

- [x] 创建 .env.local 环境变量模板文件
- [x] 配置 dotenv 自动加载机制
- [x] 更新启动脚本支持自动加载 .env 文件


## Kafka 监控实时数据推送

- [x] 创建 WebSocket 服务端点
- [x] 实现 Kafka 指标实时采集
- [x] 创建吞吐量实时图表组件
- [x] 创建延迟实时图表组件
- [x] 集成到 Kafka 监控页面


## 一键部署脚本

- [x] 创建 setup.sh 脚本
- [x] 自动检测 Node.js 并安装
- [x] 自动检测 Docker 并安装
- [x] 自动检测 pnpm 并安装
- [x] 自动启动基础设施服务
- [x] 自动配置环境变量
- [x] 自动启动应用


## 混合存储层实现

### 设备台账和诊断任务
- [ ] 设计设备台账表结构（设备信息、状态、维护记录）
- [ ] 设计诊断任务表结构（任务状态、结果、历史）
- [ ] 创建数据库迁移脚本
- [ ] 实现设备管理 CRUD API
- [ ] 实现诊断任务 CRUD API

### 时序数据存储（MySQL 模拟 ClickHouse）
- [ ] 设计遥测数据表结构（传感器读数、时间戳）
- [ ] 设计数据聚合表结构（分钟/小时/天聚合）
- [ ] 创建聚合视图和存储过程
- [ ] 实现时序数据写入 API
- [ ] 实现时序数据查询 API（支持时间范围、聚合）

### 知识图谱查询优化
- [ ] 分析现有图谱查询性能瓶颈
- [ ] 添加必要的数据库索引
- [ ] 实现图遍历优化算法
- [ ] 添加查询缓存机制

### Redis 缓存和限流
- [ ] 实现 API 响应缓存中间件
- [ ] 实现 API 限流中间件
- [ ] 配置缓存策略（TTL、失效规则）
- [ ] 添加缓存统计和监控

### 存储层管理界面
- [ ] 创建存储层概览仪表盘
- [ ] 显示各存储组件状态和统计
- [ ] 实现数据清理和维护功能


## 混合存储层实现

### ClickHouse 时序数据库集成
- [x] 添加 ClickHouse 到 Docker Compose
- [x] 创建 ClickHouse 客户端服务
- [x] 设计时序数据表结构（传感器读数、遥测数据）
- [x] 实现数据写入 API
- [x] 实现数据查询 API（支持时间范围、聚合）
- [x] 创建物化视图（分钟/小时/天聚合）

### 设备台账和诊断任务（MySQL）
- [x] 验证现有设备表结构完整性
- [x] 添加设备维护记录表
- [x] 添加设备备件库存表
- [x] 添加设备运行日志表
- [x] 添加设备告警表
- [x] 添加设备 KPI 指标表
- [x] 添加异常检测结果表
- [x] 添加诊断规则表
- [x] 添加诊断任务表
- [ ] 实现设备管理 CRUD API
- [ ] 实现诊断任务 CRUD API

### 知识图谱查询优化
- [x] 添加数据库索引优化查询
- [x] 实现图遍历优化算法（BFS、DFS路径查找）
- [x] 添加查询结果缓存

### Redis 缓存和限流
- [x] 实现 API 响应缓存中间件
- [x] 实现 API 限流中间件（滑动窗口算法）
- [x] 配置缓存策略（多种预定义策略）

### 存储层管理界面
- [ ] 创建存储层概览仪表盘
- [ ] 显示各存储组件状态


## 管道层（Pipeline）数据流处理

- [x] 创建 Pipeline 核心引擎
- [x] 实现数据源连接器（HTTP、Kafka、Database）
- [x] 实现数据处理器（字段映射、过滤、转换、聚合）
- [x] 实现数据目标连接器（HTTP、ClickHouse、Redis）
- [x] 实现流程编排和调度
- [x] 创建 Pipeline 管理 API

## 插件引擎

- [x] 设计插件接口规范（Plugin 接口、生命周期钩子）
- [x] 实现插件加载器
- [x] 实现插件生命周期管理（安装、启用、禁用、卸载）
- [x] 实现插件依赖管理
- [x] 创建插件管理 API
- [x] 内置插件（日志分析器、数据验证器、告警通知器、数据转换器）

## API 规范

- [x] 定义统一响应格式（成功/错误/分页）
- [x] 定义错误码体系（5类40+错误码）
- [x] 实现全局错误处理中间件
- [x] 集成限流中间件（5种预定义策略）
- [x] 创建 API 规范文档
