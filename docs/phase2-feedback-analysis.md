# Phase 2 三份优化意见要点归类

## 意见来源
- 意见1: 总体架构优化 + 各模块细化（HybridOrchestrator、VectorStore、CostGate、PINN、三层内存、事件总线）
- 意见2: 风险分析（映射陷阱、冷启动膨胀、记忆诅咒、流程刚性）
- 意见3: 技术方案深度评审（架构设计、技术选型、风险可观测性）

## 归类汇总

### A. 架构层面（已在v2.0采纳）
- [x] HybridReasoningOrchestrator 单入口调度器
- [x] VectorStore 向量化统一层
- [x] CostGate 动态门控
- [x] Shadow Mode (ChampionChallenger)

### B. 需要在v3.0新增/强化的要点

#### B1. PhysicsVerifier 增强
- 映射置信度字段 mappingConfidence（意见3-1）
- 低置信度时跳过物理验证（意见3-1）
- 参数边界校验（质量守恒、能量守恒）（意见2-风险1）
- 符号回归（遗传编程发现解析关系）（意见2-风险1）— 长期目标

#### B2. 推理流程增强
- 置信度阈值短路机制（意见3-2）：feasibilityScore+observationConsistency>0.9时跳过Grok
- 并行扇出（意见3-3）：阶段2→阶段3可并行验证，最大并发4-8，超时保护
- 动态路由（意见2-风险4）：简单故障跳过物理验证，紧急异常跳过经验加权
- 降级策略（意见2-风险4）：结构化推理失败时切换纯LLM推理
- 在线学习（意见2-风险4）：新故障模式实时生成临时因果假设

#### B3. 因果图增强
- 种子数据质量保障（意见3-5）：专家知识入库阶段
- confidence_level + data_source 字段（意见3-5）
- 半监督学习从历史工单挖掘候选因果边（意见2-风险2）
- 边权重衰减（长期未验证的边降低权重）（意见2-风险2）
- 因果发现算法（PC/GES）从时序数据学习（意见2-风险2）— 长期目标
- 膨胀控制（意见2-风险2）

#### B4. 经验池增强
- 衰减函数精细化（意见3-4）：decayWeight = temporal × machine_similarity × operation_similarity
- 上下文匹配（意见2-风险3）：设备年龄、累计工时、当前工况
- 经验置信度按设备状态漂移衰减（意见2-风险3）
- 元学习（意见2-风险3）— 长期目标

#### B5. Grok 编排增强
- 半结构化工具编排模板（意见3-6）：按异常域预定义工具调用优先序
- Grok在模板约束范围内灵活调整但不能跳出边界

#### B6. 知识反馈保护
- 最小样本数要求（verificationCount>=3才影响strength）（意见3-8）
- revision_log 支持回滚（意见3-8）
- 误反馈污染防护

#### B7. 可观测性
- 端到端推理延迟目标（意见3-7）：需设置实时性约束
- 每阶段关键决策点日志（意见3-9）
- 因果图查询命中率（builtin vs external）（意见3-9）
- 经验池命中率（意见3-9）
- 异步执行策略（意见3-7）

### C. 实施优先级（意见3-四）
1. 核心价值：因果图 + 物理验证器
2. 闭环收益：知识反馈环 + 经验池
3. 整合调度：结构化推理器 + ReasoningProcessor集成
